<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <title>IT 202 Project-1</title>

    <style>
        .screen{display: none;}
        #map{height: 100%;}
        html,
        body{
          height: 100%;
          margin: 0;
          padding: 0;
        }
      </style>
      <script>
      let map;
  
      function initMap(){
        map = new google.maps.Map(document.querySelector("#map"),{
          center: {lat:41.8781 , lng:-87.6298},
          zoom: 8,
        })
      }
      </script>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <!-- <a class="navbar-brand" href="#">Navbar</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button> -->
  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <div id="nav" class="navbar-nav">
      <a class="nav-item nav-link active" data-screen="home">Home <span class="sr-only">(current)</span></a>
      <a class="nav-item nav-link" data-screen="form">Form</a>
      <a class="nav-item nav-link" data-screen="data">Data</a>
      <a class="nav-item nav-link" data-screen="map">Map</a>
      <a class="nav-item nav-link" data-screen="about">About</a>
      <!-- <a class="nav-item nav-link disabled" href="#">Disabled</a> -->
    </div>
  </div>
</nav>
  </head>
  <body>
    <!-- <h1>Hello, world!</h1> -->

    <div class="screen" id="home"> Home page Content </div>
    <div class="screen" id="form"> A form to allow users to filter the data <br> 
        <form>
      <div class="form-group">
        <label for="formGroupExampleInput">Input Ward No.</label>
        <input type="text" class="form-control" id="Input" placeholder="Example input">
      </div>
      </form>
      <button type="button" class="btn btn-info" id="search">Search!</button>
      </div>
      <div class="screen" id="data"> The data in a listing form (using cards or list items), displaying<br>community_area_name - pin<br>address - square footage pin<br>
        <div class="card" >
           <div class="card-body">
             <h5 class="card-title">Card title</h5>
             <h6 class="card-subtitle mb-2 text-muted">Card subtitle</h6>
             <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
           </div>
         </div>
       </div>
       <div class="screen" id="map">The data mapped, with markers and info windows.  The info window content should be the same as above.</div>
       <script
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCZ3JlKCAfq3IFs7n4W6jYupLPnQFneyho&callback=initMap&libraries=&v=weekly"
        async>
       </script>
    <div class="screen" id="about"> About this website </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <!-- <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script> -->

    <script>
      
      document.querySelector("#home").style.display = "block";

      document.querySelectorAll("div#nav a").forEach((anchor) => {
          anchor.addEventListener("click", (event) => {
              document.querySelectorAll(".screen").forEach((screen) => {
                  screen.style.display = "none";
              })
              let screen = event.target.getAttribute("data-screen")
              let targetScreen = document.querySelector("#" + screen);
              targetScreen.style.display = "block";
          })
    })

    let endpoint = "https://data.cityofchicago.org/resource/aksk-kvfp.json"
      document.querySelector("#search").addEventListener("click",(e)=>{

      let toSearch = document.querySelector("#Input").value;
      let url = endpoint + "?ward=" + toSearch
      let cardTemp = document.querySelector(".card")
      fetch(url)
        .then((response) => { return response.json() })
        .then((data) => {
          //console.log(data)
          data.forEach((item)=>{
      let clone = cardTemp.cloneNode(true)
      let cardTitle = clone.querySelector("h5.card-title")
      let cardSubtitle = clone.querySelector("h6.card-subtitle")
      let cardText = clone.querySelector("p.card-text")
  
      cardTitle.innerText = item.community_area_name + "-" + item.pin
      cardSubtitle.innerText = item.address + "-" + item.sq_ft
      cardText.innerText = item.zip_code
  
      cardTemp.parentElement.append(clone)
      //console.log(item)

      //map markers and info windows

      let marker = new google.maps.Marker({
        position: {lat: parseFloat(item.latitude), lng: parseFloat(item.longitude) },
        map:map
      })

        const contentString = item.community_area_name + " - " + item.pin + "<br>" + item.address + " - " + item.sq_ft + "<br>" + item.zip_code;

        const infowindow = new google.maps.InfoWindow({
        content: contentString,
        });

      marker.addListener("click", () => {
      infowindow.open(map, marker);
    });



      })
          //cardTemp.remove()
        })

      })


    </script>


  </body>
</html>
